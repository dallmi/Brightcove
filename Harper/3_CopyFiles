import shutil
import os
from datetime import datetime
from dateutil.relativedelta import relativedelta

# =============================================================================
# CONFIGURATION - Set these environment variables or modify paths below
# =============================================================================
# Environment variables:
#   NETWORK_DOMAIN    - Corporate network domain (e.g., "corp.example.com")
#   NETWORK_USER_ID   - Your network user ID
#   REPORTS_BASE_PATH - Base path to reports share (e.g., "\\\\server\\share\\Reports")

NETWORK_DOMAIN = os.environ.get("NETWORK_DOMAIN", "your.network.domain")
NETWORK_USER_ID = os.environ.get("NETWORK_USER_ID", "YOUR_USER_ID")
REPORTS_BASE_PATH = os.environ.get(
    "REPORTS_BASE_PATH",
    fr"\\{NETWORK_DOMAIN}\GROUPSHARES\GLOBAL\BC-Video-Dump\DATA\_Reports"
)

# Define the source folder
source_folder = fr"\\{NETWORK_DOMAIN}\UserData\{NETWORK_USER_ID}\Home\IMPORTANT\Projects\brightcove_ori\Harper\csv"

# List of filenames
file_names = [
    "circleone_cms.csv",
    "digital_networks_events_cms.csv",
    "fa_web_cms.csv",
    "impact_cms.csv",
    "intranet_cms.csv",
    "MyWay_cms.csv",
    "neo_cms.csv",
    "research_internal_cms.csv",
    "research_cms.csv",
    "SuMiTrust_cms.csv",
    "internet_cms.csv"
]

# Generate dynamic folder suffix based on current date
# folder_suffix = datetime.now().strftime("%Y_%m")
folder_suffix = (datetime.now() + relativedelta(months=1)).strftime("%Y_%m")

# Report folder names (corresponding to file_names order)
report_folders = [
    "Circle-1--GWM",
    "DN&Events--Shared",
    "FA-Web--GWMUS",
    "Impact--GWM",
    "IntRAnet--Shared",
    "MyWay--GWM",
    "NEO--IB",
    "Research-Internal--IB",
    "Research-US--IB",
    "SuMi-Trust",
    "IntERnet--Shared"
]

# List of destination folders with dynamic suffix
destination_folders = [
    fr"{REPORTS_BASE_PATH}\{folder}\{folder_suffix}" for folder in report_folders
]

# Copy each file to its corresponding destination folder
for file_name, dest_folder in zip(file_names, destination_folders):
    source_path = os.path.join(source_folder, file_name)
    dest_path = os.path.join(dest_folder, file_name)
    print(f"Copying from {source_path} to {dest_path}")
    shutil.copy2(source_path, dest_path)

print("Files copied successfully!")